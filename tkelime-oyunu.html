<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kelime Sıralama Oyunu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { overscroll-behavior: none; touch-action: manipulation; }
    .draggable.dragging { opacity: .6; transform: scale(.98); }
    .drop-target { outline: 2px dashed rgba(99,102,241,.6); outline-offset: 4px; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-400 via-violet-400 to-pink-400">
  <div class="max-w-4xl mx-auto px-4 py-6">
    <header class="mb-4 flex items-center justify-between gap-3">
      <h1 class="text-2xl md:text-3xl font-extrabold text-white drop-shadow">🔤 Kelime Sıralama Oyunu</h1>
      <a href="index.html" class="hidden md:inline-flex items-center gap-2 px-4 py-2 rounded-full text-white font-bold bg-black/20 hover:bg-black/30">← Ana Sayfa</a>
    </header>

    <!-- Kontroller -->
    <section class="bg-white/95 rounded-2xl shadow-xl p-4 md:p-5 mb-5">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
        <div class="flex flex-col">
          <label class="text-sm text-gray-600 mb-1 font-semibold">Seviye</label>
          <select id="seviye" class="px-4 py-3 rounded-xl border-2 border-violet-300 focus:outline-none focus:ring-2 focus:ring-violet-400">
            <option value="kolay">Kolay (2 kelime)</option>
            <option value="orta">Orta (3 kelime)</option>
            <option value="zor">Zor (4 kelime)</option>
            <option value="cokzor">Çok Zor (5 kelime)</option>
          </select>
        </div>

        <div class="flex flex-col">
          <label class="text-sm text-gray-600 mb-1 font-semibold">Alt Aşama (Kolay/Orta)</label>
          <select id="altAsama" class="px-4 py-3 rounded-xl border-2 border-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400">
            <option value="diffFirst">1) İlk harfler farklı</option>
            <option value="sameFirstDiffSecond">2) İlk harf aynı, ikinci farklı</option>
            <option value="sameFirst3">3) İlk üç harf aynı</option>
          </select>
          <p class="text-xs text-gray-500 mt-1">Zor / Çok Zor seviyede alt aşama otomatik belirlenir.</p>
        </div>

        <div class="flex flex-col">
          <label class="text-sm text-gray-600 mb-1 font-semibold">Duyarlılık</label>
          <select id="duyarlilik" class="px-4 py-3 rounded-xl border-2 border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-400">
            <option value="base">Harf farkı yok (A=a)</option>
            <option value="variant">Büyük/Küçük duyarlı</option>
          </select>
        </div>

        <div class="flex items-end gap-2">
          <button id="btnYeni" class="flex-1 px-4 py-3 rounded-xl font-bold bg-violet-600 text-white active:bg-violet-700">Yeni Soru</button>
          <button id="btnKaristir" class="px-4 py-3 rounded-xl font-bold bg-fuchsia-600 text-white active:bg-fuchsia-700">Karıştır</button>
        </div>
      </div>
    </section>

    <!-- Görev Bilgisi -->
    <section class="bg-white rounded-2xl shadow-2xl p-4 md:p-6 mb-5">
      <div id="gorev" class="text-gray-700 text-sm md:text-base">
        <strong>Görev:</strong> Kelimeleri <em>sözlük sırasına</em> göre sürükleyip bırakın.
      </div>
    </section>

    <!-- Oyun Alanı -->
    <section class="bg-white rounded-2xl shadow-2xl p-4 md:p-6">
      <ul id="liste" class="space-y-3"></ul>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-5">
        <button id="btnKontrol" class="px-4 py-3 rounded-xl font-bold bg-emerald-600 text-white active:bg-emerald-700">Kontrol Et</button>
        <button id="btnCozum" class="px-4 py-3 rounded-xl font-bold bg-amber-500 text-white active:bg-amber-600">Çözümü Göster</button>
        <button id="btnKararli" class="px-4 py-3 rounded-xl font-bold bg-sky-600 text-white active:bg-sky-700">Rastgele Karışık</button>
        <button id="btnYeni2" class="px-4 py-3 rounded-xl font-bold bg-indigo-600 text-white active:bg-indigo-700">Yeni Soru</button>
      </div>

      <div id="sonuc" class="mt-4 text-center text-lg font-bold"></div>
    </section>

    <footer class="text-center text-white/90 mt-6">✨ Türkçe sözlük sırası: <code>localeCompare('tr')</code> ile kontrol edilir. ✨</footer>
  </div>

  <script>
    // --- Kelime Bankası ---
    const WORDS = [
      "araba","armut","arı","arka","arşiv","artı","ağaç","ağır","ağrı","ağız","alış","altın","ayak","ayın","ayna","ayva",
      "bal","balık","balon","balkon","balköpüğü","bambaşka","bambu","bana","banko","banka","baş","başak","başarı","başlık","başucu","başvuru","başörtü",
      "biber","bilet","bina","bir","birlik","birinci","bisküvi","bisiklet","bitki",
      "can","cana","canlı","cansız","cami","cam","cambaz","camgöbeği","cankurtaran","canavar","ceviz","ceza","cezve",
      "çadır","çakıl","çakmak","çanta","çarşı","çarpım","çarşaf","çay","çizgi","çiçek","çiğdem","çikolata","çilek","çok","çokluk",
      "dağ","dahi","dahil","dakika","dal","dalga","dama","damla","dana","dantel","darbe","darı",
      "değer","denk","deniz","dere","dergi","dert","dev","devam","devre","devrim","depo","ders","derin",
      "el","elbise","elma","elmas","elektrik","elek","eleman","elim","eller","elif",
      "fener","fen","fikir","fidan","fil","filiz","fincan","fırın","fıstık","fırça","fizik",
      "gemi","gemici","gemlik","genel","geniş","gerçek","gereç","gergi","gezi","gezegen","göl","gökyüzü","göz","gözlük","göç","göğüs","gövde",
      "harf","harita","hava","havuç","hayal","hayat","hazır","hız","hızlı","his","hiç","hindi","hikaye","hile","hobi","horoz",
      "ışık","ıspanak","ısı","ısırgan","ızgara","ırmak",
      "inek","insan","inşaat","ip","iplik","iskele","isim","istasyon","istanbul","iz","izci","izlenim",
      "jandarma","jilet","jüri","japon","jakar","jaguar",
      "kalem","kale","kalp","kaldırım","kalkış","kalkmak","kalıp","kalkan","kalın","kaleçi","kalorifer",
      "kamış","kamera","kamyon","kanat","kangal","kanun","kar","karar","karanfil","karavan","karınca","karın","kariyer","kargo","kargı",
      "kardeş","kare","karlık","karma","karne","karpuz","karşı","kart","kartal","karton",
      "kasap","kasa","kasırga","kasket","katalog","katı","katman","katkı",
      "kedi","kefil","kek","kelebek","kelle","kemik","keman","kement",
      "kış","kısa","kısım","kısıt","kır","kırgın","kırmızı","kırlangıç","kırk","kırıcı","kırıntı","kırlent",
      "kişi","kil","kilim","kilo","kilit","kiler","kim","kimya","kimlik","kimin","kir","kiraz","kirpi","kirli","kiralık",
      "kitap","kitle","kol","kola","koli","kolye","kolay","koltuk","konu","konuk","konut","konum","konser","kontrol",
      "köy","köpek","köprü","kömür","köfte","kör","körük","köşe","kök","kökten",
      "lale","lamba","lamel","lavabo","leblebi","leke","levrek","leylek","limon","lokum","lodos",
      "manav","manga","mantar","martı","masa","masal","maske","matematik","mavi","maymun",
      "merak","merdiven","merkez","meyve","metin","metot","mezun",
      "muz","müze","müzik","müşteri","mühendis","mühür","müfredat",
      "nar","narin","nane","naylon","nakış","namlu","nal","namaz","nazar",
      "okul","okuma","okyanus","ok","okçu","okşamak","okyanusya",
      "ördek","örnek","örtü","örümcek","özel","özgür","özgün","özlem","özdek",
      "pano","panda","pamuk","panjur","papatya","para","parmak","park","pastel","patates","pazar",
      "radar","radyo","raf","rahle","raket","rast","ray",
      "sandık","sanat","sandalye","sandalet","sanayi","sar","sarma","sarhoş","sarı","sarf",
      "saat","sahil","sahne","sahip","saksı","sal","salgı","salata","salıncak","salça","salon",
      "simit","simge","sincap","siyah","sistem","sıcak","sızma","sığınak","sığırcık","sığ",
      "şal","şapka","şarj","şarkı","şart","şeker","şelale","şemsiye","şifon","şifre","şirin","şişe","şömine","şoför",
      "taba","tabak","taban","tablet","tablo","tabur","tahta","tahıl","tahmin",
      "tane","tanım","tanık","tank","tavan","tavuk","tavşan","tayfa",
      "uçak","uç","uçurtma","uçurum","uçucu","uğur","uğultu","uşak",
      "üzüm","üçgen","ülke","üslup","üst","üstün",
      "vadi","valiz","vali","vakıf","vakum","vapur","varil","varlık","varis",
      "yağ","yağmur","yaka","yakıt","yaklaşım","yakın","yakut","yalnız","yamalı","yapı","yaprak","yarın","yazı","yazlık",
      "zaman","zambak","zarf","zarif","zayıf","zeytin","zil","zirve","zurna"
    ];

    function trSort(arr, sensitivity='base'){
      return [...arr].sort((a,b)=> a.localeCompare(b, 'tr', {sensitivity}));
    }
    function byPrefix(words, prefix){ return words.filter(w => w.toLowerCase().startsWith(prefix.toLowerCase())); }
    function sample(arr, n){ const c=[...arr], o=[]; while(o.length<n && c.length){const i=Math.floor(Math.random()*c.length); o.push(c.splice(i,1)[0]);} return o; }
    function altAsamaAciklama(asama){
      if(asama==='diffFirst') return "İpucu: İlk harfler farklı seçildi.";
      if(asama==='sameFirstDiffSecond') return "İpucu: İlk harf aynı, ikinci harf farklı.";
      if(asama==='sameFirst3') return "İpucu: İlk üç harf aynı.";
      return "";
    }

    function buildWords(level, sub, count){
      const words = [...WORDS];
      if(level==='kolay' || level==='orta'){
        if(sub==='diffFirst'){
          const shuffled = sample(words, words.length);
          const chosen = []; const firsts = new Set();
          for(const w of shuffled){ const f = w[0]; if(!firsts.has(f)){ firsts.add(f); chosen.push(w); } if(chosen.length===count) break; }
          return chosen.length===count ? chosen : sample(words, count);
        } else if(sub==='sameFirstDiffSecond'){
          const groups = {};
          for(const w of words){
            if(w.length<2) continue;
            const k1 = w[0], k2 = w[1];
            groups[k1] = groups[k1] || {}; groups[k1][k2] = groups[k1][k2] || []; groups[k1][k2].push(w);
          }
          const keys = Object.keys(groups);
          while(keys.length){
            const key = keys.splice(Math.floor(Math.random()*keys.length),1)[0];
            const secondGroups = groups[key];
            const seconds = Object.keys(secondGroups).filter(k=>secondGroups[k].length>0);
            if(seconds.length >= count){
              const selectedSeconds = sample(seconds, count);
              return selectedSeconds.map(s => sample(secondGroups[s],1)[0]);
            }
          }
          return sample(words, count);
        } else {
          const prefixes = new Set();
          for(const w of words){ if(w.length>=3) prefixes.add(w.slice(0,3).toLowerCase()); }
          const prefArr = [...prefixes];
          while(prefArr.length){
            const pref = prefArr.splice(Math.floor(Math.random()*prefArr.length),1)[0];
            const cands = byPrefix(words, pref);
            if(cands.length >= count) return sample(cands, count);
          }
          return sample(words, count);
        }
      } else {
        // zor & çok zor: ilk harf aynı
        const firsts = [...new Set(words.map(w=>w[0]))];
        while(firsts.length){
          const f = firsts.splice(Math.floor(Math.random()*firsts.length),1)[0];
          const cands = words.filter(w=>w[0]===f);
          if(cands.length >= count) return sample(cands, count);
        }
        return sample(words, count);
      }
    }

    function getConfig(){
      const seviye = document.getElementById('seviye').value;
      const alt = document.getElementById('altAsama').value;
      const sensitivity = document.getElementById('duyarlilik').value;
      let adet = seviye==='kolay'?2: seviye==='orta'?3: seviye==='zor'?4:5;
      let sub = (seviye==='kolay'||seviye==='orta') ? alt : 'sameFirstDiffSecond';
      return { seviye, sub, adet, sensitivity };
    }

    function renderGorev(){
      const { seviye, sub } = getConfig();
      let desc = "Kelimeleri <em>sözlük sırasına</em> göre dizin.";
      if(seviye==='kolay' || seviye==='orta'){ desc += " " + altAsamaAciklama(sub); }
      else if(seviye==='zor'){ desc += " İpucu: Tüm kelimelerin <strong>ilk harfi aynı</strong>."; }
      else { desc += " İpucu: <strong>5 kelime</strong> ve hepsinin ilk harfi aynı."; }
      document.getElementById('gorev').innerHTML = `<strong>Görev:</strong> ${desc}`;
    }

    function renderList(words){
      const liste = document.getElementById('liste');
      liste.innerHTML = '';
      const shuffled = [...words];
      for(let i=shuffled.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [shuffled[i],shuffled[j]]=[shuffled[j],shuffled[i]]; }
      shuffled.forEach((w)=>{
        const li = document.createElement('li');
        li.className = "draggable bg-gradient-to-tr from-white to-slate-50 border border-slate-200 rounded-xl p-3 flex items-center justify-between gap-3 cursor-grab";
        li.setAttribute('draggable', 'true');
        li.dataset.value = w;
        li.innerHTML = `<span class="font-bold text-lg text-slate-700">${w}</span><span class="text-slate-400 text-sm select-none">tut-sürükle</span>`;
        liste.appendChild(li);
      });

      let dragged=null;
      liste.querySelectorAll('.draggable').forEach(el=>{
        el.addEventListener('dragstart', e=>{ dragged=el; el.classList.add('dragging'); e.dataTransfer.effectAllowed='move'; });
        el.addEventListener('dragend', ()=>{ dragged=null; el.classList.remove('dragging'); liste.querySelectorAll('.draggable').forEach(x=>x.classList.remove('drop-target')); });
        el.addEventListener('dragover', e=>{ e.preventDefault(); const t=e.currentTarget; if(t===dragged) return; t.classList.add('drop-target'); });
        el.addEventListener('dragleave', e=>{ e.currentTarget.classList.remove('drop-target'); });
        el.addEventListener('drop', e=>{
          e.preventDefault();
          const t=e.currentTarget; t.classList.remove('drop-target');
          if(!dragged || dragged===t) return;
          const items = Array.from(liste.children);
          const di = items.indexOf(dragged), ti = items.indexOf(t);
          if(di<ti) liste.insertBefore(dragged, t.nextSibling); else liste.insertBefore(dragged, t);
        });
      });
    }

    let currentWords=[], correctOrder=[];
    function yeniSoru(forceLevel){
      const cfg = getConfig();
      const lvl = forceLevel || cfg.seviye;
      const words = buildWords(lvl, cfg.sub, cfg.adet);
      currentWords = words;
      correctOrder = trSort(words, cfg.sensitivity);
      renderGorev();
      renderList(words);
      document.getElementById('sonuc').textContent = "";
    }

    function kontrolEt(){
      const items = Array.from(document.querySelectorAll('#liste .draggable'));
      const userOrder = items.map(li=> li.dataset.value);
      const ok = userOrder.every((w,i)=> w===correctOrder[i]);
      const sonuc = document.getElementById('sonuc');
      if(ok){ sonuc.textContent="✅ Harika! Doğru sözlük sırası."; sonuc.className="mt-4 text-center text-lg font-bold text-emerald-600"; }
      else { sonuc.textContent="❌ Henüz olmadı. Biraz daha dene ya da 'Çözümü Göster' de."; sonuc.className="mt-4 text-center text-lg font-bold text-rose-600"; }
    }
    function cozumGoster(){ renderList(correctOrder); const s=document.getElementById('sonuc'); s.textContent="📘 Çözüm görüntülendi. 'Karıştır' ile tekrar dene."; s.className="mt-4 text-center text-lg font-bold text-sky-600"; }

    document.getElementById('btnYeni').addEventListener('click', ()=> yeniSoru());
    document.getElementById('btnYeni2').addEventListener('click', ()=> yeniSoru());
    document.getElementById('btnKaristir').addEventListener('click', ()=> renderList(currentWords));
    document.getElementById('btnKararli').addEventListener('click', ()=>{
      const seviye=document.getElementById('seviye').value;
      if(seviye==='kolay'||seviye==='orta'){
        const asamalar=['diffFirst','sameFirstDiffSecond','sameFirst3'];
        document.getElementById('altAsama').value = asamalar[Math.floor(Math.random()*asamalar.length)];
      }
      const senses=['base','variant']; document.getElementById('duyarlilik').value = senses[Math.floor(Math.random()*senses.length)];
      yeniSoru();
    });
    document.getElementById('btnKontrol').addEventListener('click', kontrolEt);
    document.getElementById('btnCozum').addEventListener('click', cozumGoster);
    document.getElementById('seviye').addEventListener('change', ()=>{
      const v=document.getElementById('seviye').value;
      document.getElementById('altAsama').disabled = !(v==='kolay'||v==='orta');
      yeniSoru(v);
    });
    document.getElementById('altAsama').addEventListener('change', ()=> yeniSoru());
    document.getElementById('duyarlilik').addEventListener('change', ()=> yeniSoru());

    yeniSoru();
  </script>
</body>
</html>
